<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue 应用性能优化指南 | 前端进阶梳理</title>
    <meta name="description" content="查缺补漏，厚积薄发">
    <link rel="icon" href="/images/favicon.ico">
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="/style.css">
    
    <link rel="preload" href="/assets/css/0.styles.17757e47.css" as="style"><link rel="preload" href="/assets/js/app.4e0435ca.js" as="script"><link rel="preload" href="/assets/js/2.04219cb5.js" as="script"><link rel="preload" href="/assets/js/62.732e2842.js" as="script"><link rel="preload" href="/assets/js/14.fa62e12d.js" as="script"><link rel="prefetch" href="/assets/js/10.fd7328de.js"><link rel="prefetch" href="/assets/js/100.6d8356e6.js"><link rel="prefetch" href="/assets/js/101.8f4a3183.js"><link rel="prefetch" href="/assets/js/102.d40f505b.js"><link rel="prefetch" href="/assets/js/103.8a69cf89.js"><link rel="prefetch" href="/assets/js/104.16723fdd.js"><link rel="prefetch" href="/assets/js/105.e3561ea4.js"><link rel="prefetch" href="/assets/js/106.1c38cbca.js"><link rel="prefetch" href="/assets/js/107.c9b7ead4.js"><link rel="prefetch" href="/assets/js/108.fec72140.js"><link rel="prefetch" href="/assets/js/109.e4d452c6.js"><link rel="prefetch" href="/assets/js/11.62420f25.js"><link rel="prefetch" href="/assets/js/110.c786ef84.js"><link rel="prefetch" href="/assets/js/111.d793af14.js"><link rel="prefetch" href="/assets/js/112.60663297.js"><link rel="prefetch" href="/assets/js/113.d2db788f.js"><link rel="prefetch" href="/assets/js/114.1005f472.js"><link rel="prefetch" href="/assets/js/115.d3d48b69.js"><link rel="prefetch" href="/assets/js/116.d0116306.js"><link rel="prefetch" href="/assets/js/117.096e81fc.js"><link rel="prefetch" href="/assets/js/118.6b1af5ca.js"><link rel="prefetch" href="/assets/js/119.0afe98c2.js"><link rel="prefetch" href="/assets/js/12.45cacbf6.js"><link rel="prefetch" href="/assets/js/120.3693037f.js"><link rel="prefetch" href="/assets/js/121.4f52f76f.js"><link rel="prefetch" href="/assets/js/122.6d51f9e1.js"><link rel="prefetch" href="/assets/js/123.6af9d3e1.js"><link rel="prefetch" href="/assets/js/124.0aae3048.js"><link rel="prefetch" href="/assets/js/125.5e3afd31.js"><link rel="prefetch" href="/assets/js/126.a8ec53ce.js"><link rel="prefetch" href="/assets/js/127.4b312a04.js"><link rel="prefetch" href="/assets/js/128.96d8d04e.js"><link rel="prefetch" href="/assets/js/129.05e536d7.js"><link rel="prefetch" href="/assets/js/13.7b9cecf2.js"><link rel="prefetch" href="/assets/js/130.1ac6a27d.js"><link rel="prefetch" href="/assets/js/131.bd67a98b.js"><link rel="prefetch" href="/assets/js/132.988d57ec.js"><link rel="prefetch" href="/assets/js/133.4d2a436c.js"><link rel="prefetch" href="/assets/js/134.6f80da26.js"><link rel="prefetch" href="/assets/js/135.b919c4a8.js"><link rel="prefetch" href="/assets/js/136.3e24bf0b.js"><link rel="prefetch" href="/assets/js/137.f2f2af70.js"><link rel="prefetch" href="/assets/js/138.5660bfd5.js"><link rel="prefetch" href="/assets/js/139.c278da1b.js"><link rel="prefetch" href="/assets/js/140.1089e7ad.js"><link rel="prefetch" href="/assets/js/141.afc3c310.js"><link rel="prefetch" href="/assets/js/142.20357454.js"><link rel="prefetch" href="/assets/js/143.205da5ee.js"><link rel="prefetch" href="/assets/js/144.44d7bb97.js"><link rel="prefetch" href="/assets/js/145.e9114ee2.js"><link rel="prefetch" href="/assets/js/15.a36fdfcc.js"><link rel="prefetch" href="/assets/js/16.26dac060.js"><link rel="prefetch" href="/assets/js/17.33c37d3b.js"><link rel="prefetch" href="/assets/js/18.9df62fb6.js"><link rel="prefetch" href="/assets/js/19.87850f83.js"><link rel="prefetch" href="/assets/js/20.727374e1.js"><link rel="prefetch" href="/assets/js/21.54b44bfc.js"><link rel="prefetch" href="/assets/js/22.a2b6288f.js"><link rel="prefetch" href="/assets/js/23.ff26b8aa.js"><link rel="prefetch" href="/assets/js/24.e116138d.js"><link rel="prefetch" href="/assets/js/25.68219dfd.js"><link rel="prefetch" href="/assets/js/26.62f0231f.js"><link rel="prefetch" href="/assets/js/27.9c31933e.js"><link rel="prefetch" href="/assets/js/28.5e7e5a76.js"><link rel="prefetch" href="/assets/js/29.76b9c597.js"><link rel="prefetch" href="/assets/js/3.e03a21f4.js"><link rel="prefetch" href="/assets/js/30.65be1bc1.js"><link rel="prefetch" href="/assets/js/31.7d6bf50f.js"><link rel="prefetch" href="/assets/js/32.73407af6.js"><link rel="prefetch" href="/assets/js/33.e9bcaf6e.js"><link rel="prefetch" href="/assets/js/34.7d2f6e9b.js"><link rel="prefetch" href="/assets/js/35.acef441e.js"><link rel="prefetch" href="/assets/js/36.93ad7b37.js"><link rel="prefetch" href="/assets/js/37.70309a57.js"><link rel="prefetch" href="/assets/js/38.9d4d713f.js"><link rel="prefetch" href="/assets/js/39.1009d0ef.js"><link rel="prefetch" href="/assets/js/4.41ee3e6d.js"><link rel="prefetch" href="/assets/js/40.eb713905.js"><link rel="prefetch" href="/assets/js/41.ce69d14f.js"><link rel="prefetch" href="/assets/js/42.13dd7ec0.js"><link rel="prefetch" href="/assets/js/43.060c75b5.js"><link rel="prefetch" href="/assets/js/44.f3b56735.js"><link rel="prefetch" href="/assets/js/45.20863ea8.js"><link rel="prefetch" href="/assets/js/46.3f27eedb.js"><link rel="prefetch" href="/assets/js/47.39b85e6f.js"><link rel="prefetch" href="/assets/js/48.3be89ba2.js"><link rel="prefetch" href="/assets/js/49.868df574.js"><link rel="prefetch" href="/assets/js/5.82ba14e2.js"><link rel="prefetch" href="/assets/js/50.9bc2f1af.js"><link rel="prefetch" href="/assets/js/51.cc6a4bf8.js"><link rel="prefetch" href="/assets/js/52.bc00435c.js"><link rel="prefetch" href="/assets/js/53.806ca95a.js"><link rel="prefetch" href="/assets/js/54.c088622d.js"><link rel="prefetch" href="/assets/js/55.ea7bfa2d.js"><link rel="prefetch" href="/assets/js/56.2956917b.js"><link rel="prefetch" href="/assets/js/57.a66acfbe.js"><link rel="prefetch" href="/assets/js/58.89d64c94.js"><link rel="prefetch" href="/assets/js/59.c9703f26.js"><link rel="prefetch" href="/assets/js/6.abd0b3ce.js"><link rel="prefetch" href="/assets/js/60.84fb508f.js"><link rel="prefetch" href="/assets/js/61.0458de69.js"><link rel="prefetch" href="/assets/js/63.2a3868a5.js"><link rel="prefetch" href="/assets/js/64.60e5bbf5.js"><link rel="prefetch" href="/assets/js/65.ced324c9.js"><link rel="prefetch" href="/assets/js/66.908a941e.js"><link rel="prefetch" href="/assets/js/67.0b996a4c.js"><link rel="prefetch" href="/assets/js/68.0ba7e054.js"><link rel="prefetch" href="/assets/js/69.0fcad8c9.js"><link rel="prefetch" href="/assets/js/7.b6580899.js"><link rel="prefetch" href="/assets/js/70.fb7aeb7c.js"><link rel="prefetch" href="/assets/js/71.aed45d21.js"><link rel="prefetch" href="/assets/js/72.28d21aa5.js"><link rel="prefetch" href="/assets/js/73.87966027.js"><link rel="prefetch" href="/assets/js/74.2c8d829a.js"><link rel="prefetch" href="/assets/js/75.076fef8d.js"><link rel="prefetch" href="/assets/js/76.940a8c15.js"><link rel="prefetch" href="/assets/js/77.b1fd3795.js"><link rel="prefetch" href="/assets/js/78.1bd92f56.js"><link rel="prefetch" href="/assets/js/79.f847dd51.js"><link rel="prefetch" href="/assets/js/8.40a63a09.js"><link rel="prefetch" href="/assets/js/80.90c3558f.js"><link rel="prefetch" href="/assets/js/81.13e87c94.js"><link rel="prefetch" href="/assets/js/82.351912c0.js"><link rel="prefetch" href="/assets/js/83.127e331e.js"><link rel="prefetch" href="/assets/js/84.adc36f35.js"><link rel="prefetch" href="/assets/js/85.09c55380.js"><link rel="prefetch" href="/assets/js/86.0d7ea8a7.js"><link rel="prefetch" href="/assets/js/87.d2e7cb67.js"><link rel="prefetch" href="/assets/js/88.26ef9b72.js"><link rel="prefetch" href="/assets/js/89.107cb5dd.js"><link rel="prefetch" href="/assets/js/9.eb1fcb81.js"><link rel="prefetch" href="/assets/js/90.65cba6f7.js"><link rel="prefetch" href="/assets/js/91.9de7f016.js"><link rel="prefetch" href="/assets/js/92.f6f1b156.js"><link rel="prefetch" href="/assets/js/93.d5e571df.js"><link rel="prefetch" href="/assets/js/94.4f308905.js"><link rel="prefetch" href="/assets/js/95.2d8fedff.js"><link rel="prefetch" href="/assets/js/96.0e986d70.js"><link rel="prefetch" href="/assets/js/97.d4dfc858.js"><link rel="prefetch" href="/assets/js/98.95b33636.js"><link rel="prefetch" href="/assets/js/99.0b93c477.js">
    <link rel="stylesheet" href="/assets/css/0.styles.17757e47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/hello-word.jpg" alt="前端进阶梳理" class="logo"> <span class="site-name can-hide">前端进阶梳理</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/md/resource/resource.html" class="nav-link">资源工具</a></div><div class="nav-item"><a href="/md/introduction/introduction.html" class="nav-link">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Javascript" class="dropdown-title"><span class="title">Javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/js/jsBasic/" class="nav-link">JavaScript基础</a></li><li class="dropdown-item"><!----> <a href="/md/js/es6/" class="nav-link">ECMAScript 6</a></li><li class="dropdown-item"><h4>JS书籍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/js/book/你不知道的javascript上.html" class="nav-link">你不知道的JavaScript(上)</a></li><li class="dropdown-subitem"><a href="/md/js/book/你不知道的javascript中.html" class="nav-link">你不知道的JavaScript(中下)</a></li><li class="dropdown-subitem"><a href="/md/js/book/es6.html" class="nav-link">深入理解ES6</a></li><li class="dropdown-subitem"><a href="/md/js/book/algorithm.html" class="nav-link">JavaScript数据结构和算法</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端概括" class="dropdown-title"><span class="title">前端概括</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/webBasics/CSS/" class="nav-link">CSS / HTML</a></li><li class="dropdown-item"><!----> <a href="/md/webBasics/Node/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----> <a href="/md/webBasics/allPath/" class="nav-link">全链路开发</a></li><li class="dropdown-item"><!----> <a href="/md/webBasics/scope/" class="nav-link">领域分支</a></li></ul></div></div><div class="nav-item"><a href="/md/frame/" class="nav-link router-link-active">框架/库</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="日积月累" class="dropdown-title"><span class="title">日积月累</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/codeBlock/module/" class="nav-link">代码模块</a></li><li class="dropdown-item"><!----> <a href="/md/codeBlock/week/" class="nav-link">每周汇总</a></li><li class="dropdown-item"><!----> <a href="/md/codeBlock/jobInterview/" class="nav-link">面试收集</a></li><li class="dropdown-item"><h4>方法论</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/1.html" class="nav-link">编程思想</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/2.html" class="nav-link">开发原则</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/3.html" class="nav-link">开发流程</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/6.html" class="nav-link">代码规范</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/4.html" class="nav-link">设计模式</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/5.html" class="nav-link">开源协议</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/md/about/" class="nav-link">关于我</a></div> <a href="https://github.com/lizheng0515/ignore/issues" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/md/resource/resource.html" class="nav-link">资源工具</a></div><div class="nav-item"><a href="/md/introduction/introduction.html" class="nav-link">导读</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Javascript" class="dropdown-title"><span class="title">Javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/js/jsBasic/" class="nav-link">JavaScript基础</a></li><li class="dropdown-item"><!----> <a href="/md/js/es6/" class="nav-link">ECMAScript 6</a></li><li class="dropdown-item"><h4>JS书籍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/js/book/你不知道的javascript上.html" class="nav-link">你不知道的JavaScript(上)</a></li><li class="dropdown-subitem"><a href="/md/js/book/你不知道的javascript中.html" class="nav-link">你不知道的JavaScript(中下)</a></li><li class="dropdown-subitem"><a href="/md/js/book/es6.html" class="nav-link">深入理解ES6</a></li><li class="dropdown-subitem"><a href="/md/js/book/algorithm.html" class="nav-link">JavaScript数据结构和算法</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端概括" class="dropdown-title"><span class="title">前端概括</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/webBasics/CSS/" class="nav-link">CSS / HTML</a></li><li class="dropdown-item"><!----> <a href="/md/webBasics/Node/" class="nav-link">Node.js</a></li><li class="dropdown-item"><!----> <a href="/md/webBasics/allPath/" class="nav-link">全链路开发</a></li><li class="dropdown-item"><!----> <a href="/md/webBasics/scope/" class="nav-link">领域分支</a></li></ul></div></div><div class="nav-item"><a href="/md/frame/" class="nav-link router-link-active">框架/库</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="日积月累" class="dropdown-title"><span class="title">日积月累</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/codeBlock/module/" class="nav-link">代码模块</a></li><li class="dropdown-item"><!----> <a href="/md/codeBlock/week/" class="nav-link">每周汇总</a></li><li class="dropdown-item"><!----> <a href="/md/codeBlock/jobInterview/" class="nav-link">面试收集</a></li><li class="dropdown-item"><h4>方法论</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/1.html" class="nav-link">编程思想</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/2.html" class="nav-link">开发原则</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/3.html" class="nav-link">开发流程</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/6.html" class="nav-link">代码规范</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/4.html" class="nav-link">设计模式</a></li><li class="dropdown-subitem"><a href="/md/codeBlock/methodology/5.html" class="nav-link">开源协议</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/md/about/" class="nav-link">关于我</a></div> <a href="https://github.com/lizheng0515/ignore/issues" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/md/frame/" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue.js</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/frame/Vue/vue.html" class="sidebar-link">1.Vue集合</a></li><li><a href="/md/frame/Vue/巧用Proxy.html" class="sidebar-link">2.巧用Proxy</a></li><li><a href="/md/frame/Vue/Vue性能优化.html" class="active sidebar-link">3.Vue性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_1-如何定位-vue-应用性能问题" class="sidebar-link">1. 如何定位 Vue 应用性能问题</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-vue-应用运行时性能优化建议" class="sidebar-link">2. Vue 应用运行时性能优化建议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-1-引入生产环境的-vue-文件" class="sidebar-link">2.1 引入生产环境的 Vue 文件</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-2-使用单文件组件预编译模板" class="sidebar-link">2.2 使用单文件组件预编译模板</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-3-提取组件的-css-到单独到文件" class="sidebar-link">2.3 提取组件的 CSS 到单独到文件</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-4-利用object-freeze-提升性能" class="sidebar-link">2.4 利用Object.freeze()提升性能</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-5-扁平化-store-数据结构" class="sidebar-link">2.5 扁平化 Store 数据结构</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-6-避免持久化-store-数据带来的性能问题" class="sidebar-link">2.6 避免持久化 Store 数据带来的性能问题</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-7-优化无限列表性能" class="sidebar-link">2.7 优化无限列表性能</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_2-8-通过组件懒加载优化超长应用内容初始渲染性能" class="sidebar-link">2.8 通过组件懒加载优化超长应用内容初始渲染性能</a></li></ul></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_3-vue-应用加载性能优化建议" class="sidebar-link">3. Vue 应用加载性能优化建议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_3-1-利用服务端渲染（ssr）和预渲染（prerender）来优化加载性能" class="sidebar-link">3.1 利用服务端渲染（SSR）和预渲染（Prerender）来优化加载性能</a></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#_3-2-通过组件懒加载优化超长应用内容加载性能" class="sidebar-link">3.2 通过组件懒加载优化超长应用内容加载性能</a></li></ul></li><li class="sidebar-sub-header"><a href="/md/frame/Vue/Vue性能优化.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/md/frame/Vue/Vue懒加载.html" class="sidebar-link">4.组件懒加载:Vue Lazy Component介绍</a></li><li><a href="/md/frame/Vue/vuepress.html" class="sidebar-link">5.vuepress集合</a></li><li><a href="/md/frame/Vue/Vue应该知道的几点.html" class="sidebar-link">6.Vue应该知道的几点</a></li><li><a href="/md/frame/Vue/虚拟DOM与DOM-diff.html" class="sidebar-link">7.虚拟DOM与DOM-diff</a></li><li><a href="/md/frame/Vue/Vue123.html" class="sidebar-link">8.Vue源码解析准备</a></li><li><a href="/md/frame/Vue/Vue源码目录.html" class="sidebar-link">9.Vue源码目录</a></li><li><a href="/md/frame/Vue/前端路由简介以及vue-router实现原理.html" class="sidebar-link">10.vue-router实现原理</a></li><li><a href="/md/frame/Vue/Vue双向数据绑定MVVM.html" class="sidebar-link">11.Vue双向数据绑定MVVM</a></li><li><a href="/md/frame/Vue/Vue使用中几个小技巧.html" class="sidebar-link">12.Vue使用中几个小技巧</a></li><li><a href="/md/frame/Vue/Vue梳理.html" class="sidebar-link">13.Vue梳理</a></li><li><a href="/md/frame/Vue/Vue组件汇总.html" class="sidebar-link">14.Vue组件汇总</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Angular</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/frame/Angular/1.html" class="sidebar-link">Angular 学习资料</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>jQuery</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/frame/jQuery/jq-versions.html" class="sidebar-link">jQuery的版本及退出舞台</a></li><li><a href="/md/frame/jQuery/jq-drawing.html" class="sidebar-link">jQuery 谱图</a></li><li><a href="/md/frame/jQuery/jq-extend.html" class="sidebar-link">jQuery extend</a></li><li><a href="/md/frame/jQuery/jquery-skill.html" class="sidebar-link">jQuery小技巧</a></li><li><a href="/md/frame/jQuery/jQuery__插件开发基础.html" class="sidebar-link">jQuery__插件开发基础</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>类库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/frame/Class/类库汇总.html" class="sidebar-link">插件、工具类库汇总</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-应用性能优化指南"><a href="#vue-应用性能优化指南" class="header-anchor">#</a> Vue 应用性能优化指南</h1> <p>得益于 Vue 的 <strong>响应式系统</strong> 和 <strong>虚拟 DOM 系统</strong> ，Vue 在渲染组件的过程中能自动追踪数据的依赖，并精确知晓数据更新的时候哪个组件需要重新渲染，渲染之后也会经过虚拟 DOM diff 之后才会真正更新到 DOM 上，Vue 应用的开发者<strong>一般不需要</strong>做额外的优化工作。</p> <p>但在实践中仍然有可能遇到性能问题，下面会介绍一些定位分析 Vue 应用性能问题的方式及一些优化的建议。</p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d789e70497?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>整体内容由三部分组成：</p> <ul><li>如何定位 Vue 应用性能问题</li> <li>Vue 应用运行时性能优化建议</li> <li>Vue 应用加载性能优化建议</li></ul> <h2 id="_1-如何定位-vue-应用性能问题"><a href="#_1-如何定位-vue-应用性能问题" class="header-anchor">#</a> 1. 如何定位 Vue 应用性能问题</h2> <p>Vue 应用的性能问题可以分为两个部分，第一部分是运行时性能问题，第二部分是加载性能问题。</p> <p>和其他 web 应用一样，定位 Vue 应用性能问题最好的工具是 Chrome Devtool，通过 Performance 工具可以用来录制一段时间的 CPU 占用、内存占用、FPS 等运行时性能问题，通过 Network 工具可以用来分析加载性能问题。<img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d789fc7786?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>例如，通过 Performance 工具的 Bottom Up 标签我们可以看出一段时间内耗时最多的操作，这对于优化 CPU 占用和 FPS 过低非常有用，可以看出最为耗时的操作发生在哪里，可以知道具体函数的执行时间，定位到瓶颈之后，我们就可以做一些针对性的优化。</p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d7dc70634d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>更多 Chrome Devtool 使用方式请参考<a href="https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/" target="_blank" rel="noopener noreferrer">使用 Chrome Devtool 定位性能问题 的指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_2-vue-应用运行时性能优化建议"><a href="#_2-vue-应用运行时性能优化建议" class="header-anchor">#</a> 2. Vue 应用运行时性能优化建议</h2> <p>运行时性能主要关注 Vue 应用初始化之后对 CPU、内存、本地存储等资源的占用，以及对用户交互的及时响应。下面是一些有用的优化手段：</p> <h3 id="_2-1-引入生产环境的-vue-文件"><a href="#_2-1-引入生产环境的-vue-文件" class="header-anchor">#</a> 2.1 引入生产环境的 Vue 文件</h3> <p>开发环境下，Vue 会提供很多警告来帮你对付常见的错误与陷阱。而在生产环境下，这些警告语句没有用，反而会增加应用的体积。有些警告检查还有一些小的<strong>运行时开销</strong>。</p> <p>当使用 webpack 或 Browserify 类似的构建工具时，Vue 源码会根据 process.env.NODE_ENV 决定是否启用生产环境模式，默认情况为开发环境模式。在 webpack 与 Browserify 中都有方法来覆盖此变量，以启用 Vue 的生产环境模式，同时在构建过程中警告语句也会被压缩工具去除。</p> <p>详细的做法请参阅 <a href="https://cn.vuejs.org/v2/guide/deployment.html" target="_blank" rel="noopener noreferrer">生产环境部署<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_2-2-使用单文件组件预编译模板"><a href="#_2-2-使用单文件组件预编译模板" class="header-anchor">#</a> 2.2 使用单文件组件预编译模板</h3> <p>当使用 DOM 内模板或 JavaScript 内的字符串模板时，模板会在<strong>运行时被编译为渲染函数</strong>。通常情况下这个过程已经足够快了，但<strong>对性能敏感的应用还是最好避免这种用法</strong>。</p> <p>预编译模板最简单的方式就是使用<strong>单文件组件</strong>——相关的构建设置会自动把预编译处理好，所以构建好的代码已经包含了编译出来的渲染函数而不是原始的模板字符串。</p> <p>详细的做法请参阅 <a href="https://cn.vuejs.org/v2/guide/deployment.html#%E6%A8%A1%E6%9D%BF%E9%A2%84%E7%BC%96%E8%AF%91" target="_blank" rel="noopener noreferrer">预编译模板<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_2-3-提取组件的-css-到单独到文件"><a href="#_2-3-提取组件的-css-到单独到文件" class="header-anchor">#</a> 2.3 提取组件的 CSS 到单独到文件</h3> <p>当使用单文件组件时，组件内的 CSS 会以 <code>&lt;style&gt;</code> 标签的方式通过 JavaScript 动态注入。这有一些小小的<strong>运行时开销</strong>，将所有组件的 CSS 提取到同一个文件可以避免这个问题，也会让 CSS 更好地进行压缩和缓存。</p> <p>查阅这个构建工具各自的文档来了解更多：</p> <ul><li><a href="https://vue-loader.vuejs.org/zh-cn/configurations/extract-css.html" target="_blank" rel="noopener noreferrer">webpack + vue-loader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (<code>vue-cli</code> 的 webpack 模板已经预先配置好)</li> <li><a href="https://github.com/vuejs/vueify#css-extraction" target="_blank" rel="noopener noreferrer">Browserify + vueify<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://vuejs.github.io/rollup-plugin-vue/#/en/2.3/?id=custom-handler" target="_blank" rel="noopener noreferrer">Rollup + rollup-plugin-vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_2-4-利用object-freeze-提升性能"><a href="#_2-4-利用object-freeze-提升性能" class="header-anchor">#</a> 2.4 利用<code>Object.freeze()</code>提升性能</h3> <p><code>Object.freeze()</code> 可以冻结一个对象，冻结之后不能向这个对象添加新的属性，不能修改其已有属性的值，不能删除已有属性，以及不能修改该对象已有属性的可枚举性、可配置性、可写性。该方法返回被冻结的对象。</p> <p>当你把一个普通的 JavaScript 对象传给 Vue 实例的  <code>data</code>  选项，Vue 将遍历此对象所有的属性，并使用  <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener noreferrer">Object.defineProperty<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>  把这些属性全部转为 getter/setter，这些 getter/setter 对用户来说是不可见的，但是在内部它们让 Vue 追踪依赖，在属性被访问和修改时通知变化。</p> <p>但 Vue 在遇到像 <code>Object.freeze()</code> 这样被设置为不可配置之后的对象属性时，不会为对象加上 setter getter 等数据劫持的方法。<a href="https://github.com/vuejs/vue/blob/v2.5.17/src/core/observer/index.js?1535281657346#L134" target="_blank" rel="noopener noreferrer">参考 Vue 源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>Vue observer 源码</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d7dc90f5c1?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <h4 id="_2-4-1-性能提升效果对比"><a href="#_2-4-1-性能提升效果对比" class="header-anchor">#</a> 2.4.1 性能提升效果对比</h4> <p>在基于 Vue 的一个 <a href="https://github.com/vuejs/vue/blob/v2.5.17/benchmarks/big-table/index.html?1535282017690" target="_blank" rel="noopener noreferrer">big table benchmark<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 里，可以看到在渲染一个一个 1000 x 10 的表格的时候，开启<code>Object.freeze()</code> 前后重新渲染的对比。</p> <p><strong>big table benchmark</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d78d944dde?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p><strong>开启优化之前</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/11/165c5feaccc752d5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p><strong>开启优化之后</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/11/165c5feadd555c81?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>在这个例子里，<strong>使用了 Object.freeze()比不使用快了 4 倍</strong></p> <h4 id="_2-4-2-为什么object-freeze-的性能会更好"><a href="#_2-4-2-为什么object-freeze-的性能会更好" class="header-anchor">#</a> 2.4.2 为什么<code>Object.freeze()</code> 的性能会更好</h4> <p><strong>不使用Object.freeze() 的CPU开销</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d7c41b64bf?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p><strong>使用 Object.freeze()的CPU开销</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d7fdffa474?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>对比可以看出，使用了 <code>Object.freeze()</code> 之后，减少了 observer 的开销。</p> <h4 id="_2-4-3-object-freeze-应用场景"><a href="#_2-4-3-object-freeze-应用场景" class="header-anchor">#</a> 2.4.3 <code>Object.freeze()</code>应用场景</h4> <p>由于 <code>Object.freeze()</code> 会把对象冻结，所以比较适合展示类的场景，如果你的数据属性需要改变，可以重新替换成一个新的 <code>Object.freeze()</code>的对象。</p> <h3 id="_2-5-扁平化-store-数据结构"><a href="#_2-5-扁平化-store-数据结构" class="header-anchor">#</a> 2.5 扁平化 Store 数据结构</h3> <p>很多时候，我们会发现接口返回的信息是如下的深层嵌套的树形结构：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;author&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Paul&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;My awesome blog post&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;comments&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;324&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;commenter&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Nicole&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>假如直接把这样的结构存储在 store 中，如果想修改某个 commenter 的信息，我们需要一层层去遍历找到这个用户的信息，同时有可能这个用户的信息出现了多次，还需要把其他地方的用户信息也进行修改，每次遍历的过程会带来额外的性能开销。</p> <p>假设我们把用户信息在 store 内统一存放成 <code>users[id]</code>这样的结构，修改和读取用户信息的成本就变得非常低。</p> <p>你可以手动去把接口里的信息通过类似数据的表一样像这样存起来，也可以借助一些工具，这里就需要提到一个概念叫做 <code>JSON数据规范化（normalize）</code>, Normalizr 是一个开源的工具，可以将上面的深层嵌套的 JSON 对象通过定义好的 schema 转变成使用 id 作为字典的实体表示的对象。</p> <p>举个例子，针对上面的 JSON 数据，我们定义 <code>users</code> <code>comments</code> <code>articles</code> 三种 schema：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>normalize<span class="token punctuation">,</span> schema<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'normalizr'</span><span class="token punctuation">;</span>

<span class="token comment">// 定义 users schema</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">schema<span class="token punctuation">.</span>Entity</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义 comments schema</span>
<span class="token keyword">const</span> comment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">schema<span class="token punctuation">.</span>Entity</span><span class="token punctuation">(</span><span class="token string">'comments'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  commenter<span class="token punctuation">:</span> user<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 定义 articles schema</span>
<span class="token keyword">const</span> article <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">schema<span class="token punctuation">.</span>Entity</span><span class="token punctuation">(</span><span class="token string">'articles'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  author<span class="token punctuation">:</span> user<span class="token punctuation">,</span>
  comments<span class="token punctuation">:</span> <span class="token punctuation">[</span>comment<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> normalizedData <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>originalData<span class="token punctuation">,</span> article<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>normalize 之后就可以得到下面的数据，我们可以按照这种形式存放在 store 中，之后想修改和读取某个 id 的用户信息就变得非常高效了，时间复杂度降低到了 O(1)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  result<span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
  entities<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;articles&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;123&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
        author<span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
        title<span class="token punctuation">:</span> <span class="token string">&quot;My awesome blog post&quot;</span><span class="token punctuation">,</span>
        comments<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;324&quot;</span> <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;users&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;1&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Paul&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">&quot;2&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Nicole&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">&quot;comments&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;324&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">&quot;324&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;commenter&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;2&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>需要了解更多请参考 normalizr 的文档 <a href="https://github.com/paularmstrong/normalizr" target="_blank" rel="noopener noreferrer">github.com/paularmstro…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_2-6-避免持久化-store-数据带来的性能问题"><a href="#_2-6-避免持久化-store-数据带来的性能问题" class="header-anchor">#</a> 2.6 避免持久化 Store 数据带来的性能问题</h3> <p>当你有让 Vue App 离线可用，或者有接口出错时候进行灾备的需求的时候，你可能会选择把 Store 数据进行持久化，这个时候需要注意以下几个方面：</p> <h4 id="_2-6-1-持久化时写入数据的性能问题"><a href="#_2-6-1-持久化时写入数据的性能问题" class="header-anchor">#</a> 2.6.1 持久化时写入数据的性能问题</h4> <p>Vue 社区中比较流行的 vuex-persistedstate，利用了 store 的 subscribe 机制，来订阅 Store 数据的 mutation，如果发生了变化，就会写入 storage 中，默认用的是 localstorage 作为持久化存储。</p> <p>也就是说默认情况下每次 commit 都会向 localstorage 写入数据，localstorage 写入是同步的，而且存在不小的性能开销，如果你想打造 60fps 的应用，就必须避免频繁写入持久化数据</p> <p>下面是开发环境下通过 Performance 工具抓取的一个截图，可以看到出现了一次长达 6s 的卡顿：</p> <p><strong>6秒钟的卡顿</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d84795d172?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>通过 Bottom-Up 可以看到 setState 占用了 3241.4ms 的 CPU 执行时间，而 setState 正是在向 Storage 写入数据。</p> <p><strong>vuex-persistedstate setState 源码</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d847a933ca?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>我们应该尽量减少直接写入 Storage 的频率：</p> <ul><li>多次写入操作合并为一次，比如采用函数节流或者将数据先缓存在内存中，最后在一并写入</li> <li>只有在必要的时候才写入，比如只有关心的模块的数据发生变化的时候才写入</li></ul> <h4 id="_2-6-2-避免持久化存储的容量持续增长"><a href="#_2-6-2-避免持久化存储的容量持续增长" class="header-anchor">#</a> 2.6.2 避免持久化存储的容量持续增长</h4> <p>由于持久化缓存的容量有限，比如 localstorage 的缓存在某些浏览器只有 5M，我们不能无限制的将所有数据都存起来，这样很容易达到容量限制，同时数据过大时，读取和写入操作会增加一些性能开销，同时内存也会上涨。</p> <p>尤其是将 API 数据进行 normalize 数据扁平化后之后，会将一份数据散落在不同的实体上，下次请求到新的数据也会散落在其他不同的实体上，这样会带来持续的存储增长。</p> <p>因此，当设计了一套持久化的数据缓存策略的时候，同时应该设计旧数据的缓存清除策略，例如请求到新数据的时候将旧的实体逐个进行清除。</p> <h3 id="_2-7-优化无限列表性能"><a href="#_2-7-优化无限列表性能" class="header-anchor">#</a> 2.7 优化无限列表性能</h3> <p>如果你的应用存在非常长或者无限滚动的列表，那么采用 <strong>窗口化</strong> 的技术来优化性能，只需要渲染少部分区域的内容，减少重新渲染组件和创建 dom 节点的时间。</p> <p><a href="https://github.com/tangbc/vue-virtual-scroll-list" target="_blank" rel="noopener noreferrer">vue-virtual-scroll-list<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://github.com/Akryum/vue-virtual-scroller" target="_blank" rel="noopener noreferrer">vue-virtual-scroller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 都是解决这类问题的开源项目。你也可以参考 Google 工程师的文章<a href="https://developers.google.com/web/updates/2016/07/infinite-scroller" target="_blank" rel="noopener noreferrer">Complexities of an Infinite Scroller<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 来尝试自己实现一个虚拟的滚动列表来优化性能，主要使用到的技术是 DOM 回收、墓碑元素和滚动锚定。</p> <p><strong>Google 工程师绘制的无限列表设计</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d8478b24bf?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <h3 id="_2-8-通过组件懒加载优化超长应用内容初始渲染性能"><a href="#_2-8-通过组件懒加载优化超长应用内容初始渲染性能" class="header-anchor">#</a> 2.8 通过组件懒加载优化超长应用内容初始渲染性能</h3> <p>上面提到的无限列表的场景，比较适合列表内元素非常相似的情况，不过有时候，你的 Vue 应用的超长列表内的内容往往不尽相同，例如在一个复杂的应用的主界面中，整个主界面由非常多不同的模块组成，而用户看到的往往只有首屏一两个模块。在初始渲染的时候不可见区域的模块也会执行和渲染，带来一些额外的性能开销。</p> <p><strong>使用组件懒加载在不可见时只需要渲染一个骨架屏，不需要真正渲染组件</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/11/165c5feaf23067e1?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>你可以对组件直接进行懒加载，对于不可见区域的组件内容，直接不进行加载和初始化，避免初始化渲染运行时的开销。具体可以参考文章 <a href="Vue%E6%87%92%E5%8A%A0%E8%BD%BD">组件懒加载 介绍</a>，了解如何做到组件粒度的懒加载。</p> <h2 id="_3-vue-应用加载性能优化建议"><a href="#_3-vue-应用加载性能优化建议" class="header-anchor">#</a> 3. Vue 应用加载性能优化建议</h2> <h3 id="_3-1-利用服务端渲染（ssr）和预渲染（prerender）来优化加载性能"><a href="#_3-1-利用服务端渲染（ssr）和预渲染（prerender）来优化加载性能" class="header-anchor">#</a> 3.1 利用服务端渲染（SSR）和预渲染（Prerender）来优化加载性能</h3> <p>在一个单页应用中，往往只有一个 html 文件，然后根据访问的 url 来匹配对应的路由脚本，动态地渲染页面内容。单页应用比较大的问题是首屏可见时间过长。</p> <p>单页面应用显示一个页面会发送多次请求，第一次拿到 html 资源，然后通过请求再去拿数据，再将数据渲染到页面上。而且由于现在微服务架构的存在，还有可能发出多次数据请求才能将网页渲染出来，每次数据请求都会产生 RTT（往返时延），会导致加载页面的时间拖的很长。</p> <p><strong>服务端渲染、预渲染和客户端渲染的对比</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/10/165c22d84c84cebf?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>这种情况下可以采用服务端渲染（SSR）和预渲染（Prerender）来提升加载性能，这两种方案，用户读取到的直接就是网页内容，由于少了节省了很多 RTT（往返时延），同时，还可以对一些资源内联在页面，可以进一步提升加载的性能。</p> <p>服务端渲染（SSR）可以考虑使用 Nuxt 或者按照 Vue 官方提供的 <a href="https://ssr.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">Vue SSR 指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>来一步步搭建。</p> <h3 id="_3-2-通过组件懒加载优化超长应用内容加载性能"><a href="#_3-2-通过组件懒加载优化超长应用内容加载性能" class="header-anchor">#</a> 3.2 通过组件懒加载优化超长应用内容加载性能</h3> <p>在上面提到的超长应用内容的场景中，通过组件懒加载方案可以优化初始渲染的运行性能，其实，这对于优化应用的加载性能也很有帮助。</p> <p>组件粒度的懒加载结合异步组件和 webpack 代码分片，可以保证按需加载组件，以及组件依赖的资源、接口请求等，比起通常单纯的对图片进行懒加载，更进一步的做到了按需加载资源。</p> <p><strong>使用组件懒加载之前的请求瀑布图</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/11/165c5feb03e51a44?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p><strong>使用组件懒加载之后的请求瀑布图</strong></p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/11/165c5feb14c9cd5c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>使用组件懒加载方案对于超长内容的应用初始化渲染很有帮助，可以减少大量必要的资源请求，缩短渲染关键路径</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>本文总结了 Vue 应用运行时以及加载时的一些性能优化措施，下面做一个回顾和概括：</p> <ul><li>Vue 应用运行时性能优化措施
<ul><li>引入生产环境的 Vue 文件</li> <li>使用单文件组件预编译模板</li> <li>提取组件的 CSS 到单独到文件</li> <li>利用<code>Object.freeze()</code>提升性能</li> <li>扁平化 Store 数据结构</li> <li>合理使用持久化 Store 数据</li> <li>组件懒加载</li></ul></li> <li>Vue 应用加载性能优化措施
<ul><li>服务端渲染 / 预渲染</li> <li>组件懒加载</li></ul></li></ul> <blockquote><p>原文地址：<a href="">Vue 应用性能优化指南</a></p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/md/frame/Vue/巧用Proxy.html" class="prev">2.巧用Proxy</a></span> <span class="next"><a href="/md/frame/Vue/Vue懒加载.html">4.组件懒加载:Vue Lazy Component介绍</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.4e0435ca.js" defer></script><script src="/assets/js/2.04219cb5.js" defer></script><script src="/assets/js/62.732e2842.js" defer></script><script src="/assets/js/14.fa62e12d.js" defer></script>
  </body>
</html>
